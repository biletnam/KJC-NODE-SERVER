{"version":3,"sources":["../../rest_controller/seats.js"],"names":["express","require","router","Router","seatService","Joi","get","req","res","BRCH_ID","params","CINEMA_NO","status","send","findSeatsByCinemaNoAndBranchID","then","data","catch","error","console","log","put","validateSeatUpdate","body","details","message","cinemaNumber","branchId","seatTypeId","seatObject","selectedSeatNames","map","seatName","SEAT_TYPE_ID","SEAT_NAME","updateSeatsSeatType","result","seatUpdate","scheme","number","required","array","validate","module","exports"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,SAASF,QAAQG,MAAR,EAAf;AACA,IAAMC,cAAcH,QAAQ,8BAAR,CAApB;AACA,IAAMI,MAAMJ,QAAQ,KAAR,CAAZ;;AAEAC,OAAOI,GAAP,CAAW,sBAAX,EAAmC,UAACC,GAAD,EAAKC,GAAL,EAAa;AAC5C,QAAMC,UAAUF,IAAIG,MAAJ,CAAWD,OAA3B;AACA,QAAME,YAAYJ,IAAIG,MAAJ,CAAWC,SAA7B;;AAEA,QAAG,CAACF,OAAD,IAAY,CAACE,SAAhB,EAA2B;AACvBH,YAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,8BAArB;AACA;AACH;;AAEDT,gBAAYU,8BAAZ,CAA2CH,SAA3C,EAAsDF,OAAtD,EACKM,IADL,CACU,UAACC,IAAD;AAAA,eAAUR,IAAIK,IAAJ,CAASG,IAAT,CAAV;AAAA,KADV,EAEKC,KAFL,CAEW,UAACC,KAAD,EAAW;AAACC,gBAAQC,GAAR,CAAYF,KAAZ,EAAoBV,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,WAArB;AAAmC,KAF9E;AAGH,CAZD;;AAcAX,OAAOmB,GAAP,CAAW,WAAX,EAAwB,UAACd,GAAD,EAAKC,GAAL,EAAa;AAAA,8BACjBc,mBAAmBf,IAAIgB,IAAvB,CADiB;AAAA,QAC1BL,KAD0B,uBAC1BA,KAD0B;;AAEjC,QAAGA,KAAH,EAAU;AACNV,YAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBK,MAAMM,OAAN,CAAc,CAAd,EAAiBC,OAAtC;AACA;AACH;AACD,QAAMC,eAAenB,IAAIgB,IAAJ,CAASG,YAA9B;AACA,QAAMC,WAAWpB,IAAIgB,IAAJ,CAASI,QAA1B;AACA,QAAMC,aAAarB,IAAIgB,IAAJ,CAASK,UAA5B;AACA,QAAMC,aAAatB,IAAIgB,IAAJ,CAASO,iBAAT,CAA2BC,GAA3B,CAA+B,UAACC,QAAD,EAAc;AAC5D,eAAO;AACHC,0BAAcL,UADX;AAEHnB,qBAASkB,QAFN;AAGHhB,uBAAWe,YAHR;AAIHQ,uBAAWF;AAJR,SAAP;AAMH,KAPkB,CAAnB;AAQAb,YAAQC,GAAR,CAAYS,UAAZ;AACAzB,gBAAY+B,mBAAZ,CAAgCN,UAAhC,EACKd,IADL,CACU,UAACqB,MAAD;AAAA,eAAY5B,IAAIK,IAAJ,CAAS,SAAT,CAAZ;AAAA,KADV,EAEKI,KAFL,CAEW,UAACC,KAAD;AAAA,eAAWV,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBK,KAArB,CAAX;AAAA,KAFX;AAGH,CArBD;AAsBA,SAASI,kBAAT,CAA4Be,UAA5B,EAAwC;AACpC,QAAMC,SAAS;AACXZ,sBAAcrB,IAAIkC,MAAJ,GAAaC,QAAb,EADH;AAEXb,kBAAUtB,IAAIkC,MAAJ,GAAaC,QAAb,EAFC;AAGXZ,oBAAYvB,IAAIkC,MAAJ,GAAaC,QAAb,EAHD;AAIXV,2BAAmBzB,IAAIoC,KAAJ,GAAYD,QAAZ;AAEvB;AANe,KAAf,CAOA,OAAOnC,IAAIqC,QAAJ,CAAaL,UAAb,EAAwBC,MAAxB,CAAP;AACH;AACDK,OAAOC,OAAP,GAAiB1C,MAAjB","file":"seats.js","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst seatService = require('./oraclDBService/seatService');\r\nconst Joi = require('joi');\r\n\r\nrouter.get('/:CINEMA_NO/:BRCH_ID', (req,res) => {\r\n    const BRCH_ID = req.params.BRCH_ID;\r\n    const CINEMA_NO = req.params.CINEMA_NO;\r\n\r\n    if(!BRCH_ID || !CINEMA_NO) {\r\n        res.status(405).send('check Branch ID or cinema NO');\r\n        return;\r\n    }\r\n\r\n    seatService.findSeatsByCinemaNoAndBranchID(CINEMA_NO, BRCH_ID)\r\n        .then((data) => res.send(data))\r\n        .catch((error) => {console.log(error); res.status(404).send('not found');})\r\n})\r\n\r\nrouter.put('/seatType', (req,res) => {\r\n    const {error} = validateSeatUpdate(req.body);\r\n    if(error) {\r\n        res.status(400).send(error.details[0].message);\r\n        return;\r\n    }\r\n    const cinemaNumber = req.body.cinemaNumber;\r\n    const branchId = req.body.branchId;\r\n    const seatTypeId = req.body.seatTypeId;\r\n    const seatObject = req.body.selectedSeatNames.map((seatName) => {\r\n        return {\r\n            SEAT_TYPE_ID: seatTypeId,\r\n            BRCH_ID: branchId,\r\n            CINEMA_NO: cinemaNumber,\r\n            SEAT_NAME: seatName\r\n        }\r\n    });\r\n    console.log(seatObject);\r\n    seatService.updateSeatsSeatType(seatObject)\r\n        .then((result) => res.send('success'))\r\n        .catch((error) => res.status(400).send(error));\r\n})\r\nfunction validateSeatUpdate(seatUpdate) {\r\n    const scheme = {\r\n        cinemaNumber: Joi.number().required(),\r\n        branchId: Joi.number().required(),\r\n        seatTypeId: Joi.number().required(),\r\n        selectedSeatNames: Joi.array().required()\r\n    }\r\n    //\t\tminAge: Joi.number().required(),\r\n    return Joi.validate(seatUpdate,scheme);\r\n}\r\nmodule.exports = router;"]}